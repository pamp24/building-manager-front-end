<div class="row">
  <div class="col-12" *ngIf="showBuildingSelector">
    <app-card cardTitle="Επιλογή Πολυκατοικίας" [padding]="24">
      <app-building-selector (buildingSelected)="onBuildingSelected($event)"></app-building-selector>
    </app-card>
  </div>

  <div class="row align-items-stretch">
    <div class="col-lg-9 d-flex">
      <app-invoice-chart class="flex-fill h-100" [monthlyStats]="dashboardData?.monthlyStats || []"></app-invoice-chart>
    </div>

    <div class="col-lg-3 d-flex">
      <app-card class="flex-fill h-100" [showHeader]="false">
        <app-status-cards [dashboardData]="dashboardData" (tabSelected)="goToTab($event)"></app-status-cards>
      </app-card>
    </div>
  </div>

  <div class="col-sm-12">
    <app-card [cardTitle]="'Πληρωμές Χρηστών για Παραστατικό'" [padding]="0">
      <ng-template #headerOptionsTemplate>
        <button class="btn btn-sm btn-link-primary" (click)="goToInvoiceList()">Περισσότερα</button>
      </ng-template>

      <!--Dropdown παραστατικού -->
      <div class="d-flex align-items-center justify-content-start ms-3 mt-3 mb-3">
        <label for="statementSelect" class="me-2 fw-semibold">Παραστατικό:</label>
        <select
          id="statementSelect"
          class="form-select form-select-sm w-auto"
          [(ngModel)]="selectedStatementId"
          (change)="onStatementChange()"
        >
          <option *ngFor="let s of statements" [value]="s.id">{{ s.code }} ({{ s.startDate | date: 'MMM yyyy' }})</option>
        </select>
      </div>

      <app-user-payments-table
        [statementUserPayments]="statementUserPayments"
        [currentMonthLabel]="currentMonthLabel"
        [paymentsLoading]="paymentsLoading"
        (editUser)="onEditUser($event)"
      ></app-user-payments-table>
    </app-card>
  </div>

  <div class="col-md-6 col-xl-4">
    <app-card cardTitle="Πρόσφατες Πληρωμές" [padding]="0">
      <app-recent-payments [recentPayments]="recentPayments"></app-recent-payments>
    </app-card>
  </div>

  <div class="col-md-6 col-xl-4" *ngIf="currentBuilding">
    <app-total-expenses-chart *ngIf="currentBuilding" [buildingId]="buildingId" [attr.key]="buildingId"></app-total-expenses-chart>
  </div>

  <div class="col-sm-12 col-xl-4">
    <app-card cardTitle="Ανακοινώσεις" [padding]="0">
      <ng-template #headerOptionsTemplate>
        <div ngbDropdown placement="bottom-end">
          <a class="avatar avatar-s btn-link-secondary arrow-none" href="javascript:" ngbDropdownToggle>
            <i class="f-18" antIcon type="more" theme="outline"></i>
          </a>
          <div ngbDropdownMenu>
            <a ngbDropdownItem>Today</a>
            <a ngbDropdownItem>Weekly</a>
            <a ngbDropdownItem>Monthly</a>
          </div>
        </div>
      </ng-template>
      <ul class="list-group list-group-flush border-top-0">
        <li class="list-group-item border-0">
          <div class="d-grid">
            <button class="btn btn-outline-secondary">Προβολή Όλων</button>
          </div>
        </li>
      </ul>
    </app-card>
  </div>
</div>
